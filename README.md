# AI Tattoo Generator

A full-stack application that allows users to generate tattoo designs based on text prompts, overlay tattoos on images, and manage their generated artwork. The frontend is built with **Next.js** and the backend with **Flask**, using a local SQLite database. Images can be generated via a Stable Diffusion model running locally.

---

## Features

- **User Authentication**: Users can log in with a username and receive a simple token.
- **Tattoo Generation**: Users can generate tattoo images from text prompts.
- **Overlay Tattoos**: Users can overlay a tattoo on a base image with custom position, scale, rotation, and opacity.
- **Image History**: Users can view all generated images or just their own.
- **Offline Generation Option**: Works fully offline with a local Stable Diffusion model.

---

## Tech Stack

- **Frontend**:
  - Next.js 15
  - React
  - Vanilla CSS (no Tailwind, fully custom)
- **Backend**:
  - Python 3.10+
  - Flask
  - SQLite (database)
  - Pillow (for image overlay)
  - Requests (for API calls)
- **Optional AI Backend**:
  - Stable Diffusion (Automatic1111 WebUI or `diffusers` Python library)

---

## Backend Setup

1. **Create and activate a virtual environment**:

```bash
cd backend
python3 -m venv venv
source venv/bin/activate
```

2. **Install dependencies**

```bash
pip install -r requirements.txt
```

3. **Set environment variables (optional, defaults provided)**

```bash
export A1111_BASE=http://127.0.0.1:7860  #URL for Automatic1111 WebUI
```

4. **Run the Flask server**

```bash
python app.py
```

## Frontend Setup

1. **Install Node.js dependencies**

```bash
cd frontend
npm install
```

2. **Run the frontend**

```bash
npm run dev
```

## API Endpoints

1. **POST /api/login**
Logs in a user and returns a token

```json
{ "username": "javier" }
```

2. **POST /api/generate**
Generates a tattoo image from a prompt

```json
{   
  "user_id": 1,
  "prompt": "Dragon tattoo on shoulder",
  "steps": 20,
  "width": 512,
  "height": 512
}
```

3. **GET /api/images**
Returns the last 20 generated images

4. **GET /api/my-images?user_id=1**
Returns images generated by the specified user

5. **POST /api/overlay**
Overlays a tattoo on a base image with options for position, scale, rotation, and opacity. Requires multipart/form-data:
- base: base image file
- tattoo: tattoo image file
- x, y, scale, rotation, opacity as form fields
